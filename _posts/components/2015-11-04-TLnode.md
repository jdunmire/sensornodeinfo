---
layout: component
title:  "T&L Node"
summary: "This was the first node developed. It measures temperature,
light levels, and includes an event input for future use."
started: 2015-05-20
date:   2015-12-06
status: active
repository: https://github.com/jdunmire/TLnode
commentIssueId: 4
permalink: /component/tlnode/
categories:
- component
- Hardware
img: TLnode.jpg
thumb: TLnode_70x53.png
carousel:
- TLnode1.jpg,Completed module. ESP-12 version.
- TLnode2.jpg,Completed module. ESP-07 version (failed due to limited
    ESP-07 memory).
- TLnode3.jpg,Starting reflow- the remaining components will be hand
    soldered.
---
####Concept
  * Simple
  * Low cost
  * Battery operated
  * Small

The original concept only measured temperature. However that seemed like
a waste of signals, processing power and board space so a light sensor
and a motion sensor were added.

Full schematics for the T&L Node are available on
[GitHub](https://github.com/jdunmire/TLnode).

As of December 2015, six (6) T&L Nodes have been build using boards
fabricated by [OSH Park](https://oshpark.com) with most of the parts
purchased from [DigiKey](http://www.digikey.com/). The ESP-12 modules
were purchased from [Amazon](https://www.amazon.com/) and
[Bang good](http://www.banggood.com).

The total cost of parts, including the PCB, but not the batteries or the motion
sensor was $15.56 each.

####CPU
  * [ESP-12](http://www.esp8266.com/wiki/doku.php?id=esp8266-module-family#esp-12),
  an [ESP8266](https://nurdspace.nl/ESP8266) module available at low cost.

####Temperature
Temperature is measured using the
[DS18B20-PAR][PAR]

[PAR]: https://www.maximintegrated.com/en/products/analog/sensors-and-sensor-interface/DS18B20-PAR.html

This part was chosen because I have worked with it before and found it
easy to use. I designed the T&L Node to use the
[DS18B20][nonPAR].

[nonPAR]: https://www.maximintegrated.com/en/products/analog/sensors-and-sensor-interface/DS18B20.html

The difference between the
[DS18B20][nonPAR]
and the 
[DS18B20-PAR][PAR].
is that the -PAR version gets its power from the data line and the
non-PAR version requires a separate power connection. Though I designed the T&L
Node for the non-PAR version, I accidently ordered the -PAR version.
The two versions are pin-compatible so only the firmware had to change.

The  DS18B20 (either version) was not a very good choice because it has
a higher minimum operating voltage (3v) than the other components. The
parts I have received seem to work fine to voltages as low as 2.5v, but
that can't be expected of all parts.

####Light
The light sensor is an Intersil [ISL29035][ISL]. It was chosen because
it has an I2C interface, its power supply range (2.25V-3.63V) and
relatively low cost ($1.62 from
[DigiKey](https://www.digikey.com/product-search/en?keywords=ISL29035IROZ-T7-ND])).

The sensor is smaller that I envisioned when I was designing the T&L
Node. It turned out to be difficult to identify pin 1 on the part when
placing it on the PCB. That said, I didn't have any problems getting it
soldered to the board using the hot-plate/embossing-tool relfow method.


[ISL]: http://www.intersil.com/en/products/optoelectronics/ambient-light-sensors/light-to-digital-sensors/ISL29035.html

####Motion Sensor
The motion sensor does not mount on the T&L Node, but a connector was
added to allow the use of the [HC-SR501][SR501] Passive Infrared Motion
sensor from [Adafruit][ada_SR501].

As of December 2015 the T&L Node firmware as not been written to support
the motion sensor.

[SR501]: http://www.electrodragon.com/w/index.php?title=HC-SR501_PIR_Motion_Sensor_%28Passive_Infrared_Sensor%29
[ada_SR501]: https://www.adafruit.com/products/189

####Power
I wanted the simplest possible design for the T&L Node, so I chose to
power the unit directly from batteries. This turns out to be the weakest
part of the design.

The documentation (at least when the design was started) for the ESP8266
seemed to indicated that the operating voltage was 1.75-3.6V, but that
is now known to be [correct for only the IO
drivers][vRange]

[vRange]:http://forum.makehackvoid.com/t/esp8266-operating-voltage-range-and-sleep-current/286

Still, the first T&L Nodes have worked with battery voltages as low as
2.5V.

The battery life is dependend on the battery capacity, operating current
of the T&L Node, the sleep mode current, and the duty cycle between the
two. Transmitting measurements every 5 minutes yields about 2 months using alkaline
batteries. Using a single [rechargable LiFeP04 cell][LiFeP04] yields only
2-3 weeks due to it's lower capacity.

[LiFeP04]: http://www.batteryspace.com/lifepo4-rechargeable-14505-cell-3-2v-600-mah-0-6a-rate-2-22wh-button-top-standard-aa-size-0-18----un38-3-passed-ndgr.aspx

The alkaline battery discharge characteristics are such that most the capacity is
available only by operating at voltages under 3v (for two cells). This is a problem
(based on specs) for the temperature sensor and possibly the [ESP8266][vRange].

LiFeP04 batteries are a better choice, from a stable voltage point of view, than alkaline
batteries but the lower power density makes LiFeP04 a less attactive choice.

A future designs will need a better power source. The extra cost of a charging
circuit and power connector may be worth it in order to use Li batteries and get
extended run time.

